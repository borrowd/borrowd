{% extends "items/layout.html" %}

{% block head_title %}Items{% endblock %}
{% block items_content %}
<div class="flex flex-col space-y-4">
    <c-box>
        <div class="flex justify-between items-center">
            <c-h1>Items</c-h1>
            <c-button-nav url="{% url 'item-create' %}">Create New Item</c-button-nav>
        </div>
        <!-- todo: I'd love to clean this form up or else tuck it away in a component somewhere -->
        <form method="get" class="flex flex-col space-y-4">
            <input type="text" name="{{ filter.form.search.html_name }}" id="{{ filter.form.search.id_for_label }}"
            class="w-full px-3 py-2 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            value="{{ filter.form.search.value|default:'' }}"
            placeholder="Search items...">

            <div class="flex flex-col">
                <label for="{{ filter.form.category.id_for_label }}" class="text-sm font-medium text-gray-700 mb-1">Category</label>
                <select name="{{ filter.form.category.html_name }}" id="{{ filter.form.category.id_for_label }}"
                   class="w-1/3 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                   {% for choice in filter.form.category.field.choices %}
                   <option value="{{ choice.0 }}" {% if filter.form.category.value == choice.0|stringformat:"s" %}selected{% endif %}>
                       {{ choice.1 }}
                   </option>
                   {% endfor %}
                </select>
            </div>
            <div class="flex gap-4">
                <input type="submit" value="Filter" class="bg-blue-500 w-fit text-white px-4 py-2 rounded">
                {% comment %}
                Only show the Clear button if filters are actually set.
                This looks a bit awkward in order to account for empty filters,
                i.e. `?category=&search=`
                TODO: Replace this with Alpine.js logic later
                when we're also using HTMX to avoid page reloads here.
                {% endcomment %}
                {% if not request.GET.values|join:"" == "" %}
                <c-button-nav url="{% url 'item-list' %}">Clear</c-button-nav>
                {% endif %}
            </div>
        </form>
        <c-divider />
        <!-- todo: tabs for My Inventory vs. Browser? -->
        <div class="flex flex-col space-y-4 mt-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 place-items-center">
                {% for item in item_list %}
                <c-item-box :item="{{ item }}" />
                {% endfor %}
            </div>
        </div>
    </c-box>
</div>
{% endblock %}
