<!-- Item Filter Form Component -->
<form method="get" class="flex flex-col space-y-4">
    <input type="text" name="{{ filter.form.search.html_name }}" id="{{ filter.form.search.id_for_label }}"
           class="w-full px-3 py-2 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
           value="{{ filter.form.search.value|default:'' }}"
           placeholder="Search items...">

    <div class="flex flex-col gap-3 md:flex-row md:items-start">
        <div class="flex flex-col w-full">
            <label for="{{ filter.form.categories.id_for_label }}" class="text-sm font-medium text-gray-700">
                {{ filter.form.categories.label }}
            </label>
            {% with selected_values=filter.form.categories.value %}
            <select name="{{ filter.form.categories.html_name }}" id="{{ filter.form.categories.id_for_label }}"
                    multiple
                    class="w-full md:w-2/3 px-3 py-2 h-32 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                {% for choice in filter.form.categories.field.choices %}
                    {% with choice_value=choice.0|stringformat:"s" %}
                    <option value="{{ choice_value }}" {% if selected_values and choice_value in selected_values %}selected{% endif %}>
                        {{ choice.1 }}
                    </option>
                    {% endwith %}
                {% endfor %}
            </select>
            {% endwith %}
            <p class="text-xs text-gray-500 mt-1">Choose one or more categories</p>
        </div>
        <div class="flex gap-4">
            <input type="submit" value="Filter" class="bg-blue-500 w-fit text-white px-4 py-2 rounded">
            {% comment %}
            Only show the Clear button if filters are actually set.
            This looks a bit awkward in order to account for empty filters,
            i.e. `?categories=&search=`
            TODO: Replace this with Alpine.js logic later
            when we're also using HTMX to avoid page reloads here.
            {% endcomment %}
            {% if not request.GET.values|join:"" == "" %}
                <c-button-nav url="{% url 'item-list' %}">Clear</c-button-nav>
            {% endif %}
        </div>
    </div>
</form>
