{% extends "layouts/default.html" %}
{% load static %}

{% block head_title %}Inventory{% endblock %}

{% block content %}
<div class="flex flex-col w-full px-4 max-w-2xl bg-base-100" x-data="{ yourItems: true }">

    <!-- Page Header -->
    <c-page-header title="Inventory" />

    <!-- Toggle Row -->
    <div class="flex items-center justify-between mb-6">
        <label class="flex items-center gap-3 cursor-pointer">
            <input type="checkbox" class="toggle toggle-base" x-model="yourItems" />
            <span class="text-sm font-medium">Your items</span>
        </label>
        <a href="{% url 'item-create' %}" class="btn btn-soft text-primary btn-sm">
            Add item
        </a>
    </div>

    <!-- Your Items Mode (toggle ON) -->
    <template x-if="yourItems">
        <div>
            {% if has_owned_items %}
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 justify-items-center sm:justify-items-start">
                <!-- Items you own that other users have requested to borrow — you need to approve or decline -->
                {% for card in requests_to_approve %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you own that are currently being borrowed by someone else -->
                {% for card in lent_out %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you own that are available and not requested by anyone -->
                {% for card in available %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}
            </div>
            {% else %}
            <!-- Empty State: No owned items -->
            <div class="flex flex-col items-center justify-center py-12 px-4">
                <img src="{% static 'users/inventory/frame-illustration-2.png' %}" alt="No items" class="w-32 h-32 mb-6">
                <p class="text-gray-800 text-xl text-center font-semibold mb-2">You have no items</p>
                <p class="text-gray-600 text-center mb-6">Add an item to start sharing.</p>
                <a href="{% url 'item-create' %}" class="btn btn-primary">
                    Add an item
                </a>
            </div>
            {% endif %}
        </div>
    </template>

    <!-- All Items Mode (toggle OFF) -->
    <template x-if="!yourItems">
        <div>
            {% if has_activity or has_owned_items %}
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 justify-items-center sm:justify-items-start">
                <!-- Items you own that other users have requested to borrow — you need to approve or decline -->
                {% for card in requests_to_approve %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you requested to borrow from others — waiting on the owner's decision -->
                {% for card in pending_requests %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you own that are currently being borrowed by someone else -->
                {% for card in lent_out %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you are currently borrowing from other users -->
                {% for card in borrowing %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}

                <!-- Items you own that are available and not requested by anyone -->
                {% for card in available %}
                    {% include "components/items/_inventory_card.html" with ctx=card %}
                {% endfor %}
            </div>
            {% else %}
            <!-- Empty State: No requests/borrowed items -->
            <div class="flex flex-col items-center justify-center py-12 px-4">
                <img src="{% static 'users/inventory/relax-1.png' %}" alt="No requests" class="w-32 h-32 mb-6">
                <p class="text-gray-800 text-xl text-center font-semibold mb-2">No requests yet</p>
                <p class="text-gray-600 text-center">Once someone requests your items, they will be here for your approval and tracking.</p>
            </div>
            {% endif %}
        </div>
    </template>
</div>
{% endblock %}
