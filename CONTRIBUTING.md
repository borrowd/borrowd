# Contributing

## Dev env setup

This project uses [`uv`](https://docs.astral.sh/uv/) and
[`pre-commit`](https://pre-commit.com/).

### 1. Install `uv` and tools

```
curl -LsSf https://astral.sh/uv/install.sh | sh
uv tool install ruff
uv tool install pre-commit
```

### 2. Clone repo

```
git clone git@github.com:borrowd/borrowd.git && cd borrowd/
```

### 3. Install all dependencies

```
# This will automatically create a local Python virtual environment
# at .venv
uv sync
```

### 4. Create local `.env` file

This project uses [`django-environ`](https://pypi.org/project/django-environ/)
to manage env-var based configurability for the app. It expects the
`.env` file to sit in the root of the repository, above the `borrowd/`
Django project directory and the various sibling Django app dirs
(`borrowd_items/`, etc.)

An example `.env` file is included in the repo at `.env.example`.
As part of your setup, copy this to `.env`; it contains values which
are appropriate for local development.

```bash
cp .env.example .env
```

### 5. Django stuff

Now all your tooling is installed, you're ready to fire up the
Borrow'd app locally.

Note that you don't _need_ to `activate` your Python `venv` to do
this; `uv` provides a useful shorthand to automatically make use
of the local `venv`, using its `run` subcommand:

```
uv run manage.py migrate
uv run manage.py runserver
```

At this point, your local Borrow'd checkout should be running at
http://127.0.0.1:8000/.

## Working with tools via `uv`

Use the `uvx` command to invoke tools installed via `uv`:

```
uvx ruff format
uvx pre-commit
```

## Repo layout

The Django
[Project](https://docs.djangoproject.com/en/5.2/intro/tutorial01/#creating-a-project)
is in the `borrowd/` directory. Django
[apps](https://docs.djangoproject.com/en/5.2/ref/django-admin/#startapp)
are created to namespace code and assets for different aspects of the
project: users, groups, etc. Note that while the top-level app dirs
are prefixed with `borrowd_`, the model class names therein are not
(e.g. `borrowd_items.models.`**`Item`**, not `BorrowdItem`).

There are top-level dirs for `templates/` and `static/` assets which are
shared across the project, however there may also be `templates/` and
`static/` subdirs of the various `borrowd_*` app dirs.

## Front-end

We do not use a full frontend framework like React or Vue.

All markup is generated by the backend, mostly using Django's standard
templating system (similar to [Jinja2](https://jinja.palletsprojects.com/en/stable/templates/#synopsis)).

We use [django-cotton](https://django-cotton.com/) to enable creating
reusable UI components.
[django-template-partials](https://pypi.org/project/django-template-partials/)
can also help with reuse.

The intention is to use a lightweight Javascript microframework for
declarative interactivity where needed, e.g. [alpine.js](https://alpinejs.dev/)
or [htmx](https://htmx.org/).

## Users and Authentication

We use [django-allauth](https://allauth.org/) for authentication. The
few, specific templates we have needed to override are under the
top-level templates folder, at `templates/account/` and `templates/allauth/`.

We have not used a
[custom user model](https://docs.djangoproject.com/en/5.2/topics/auth/customizing/#substituting-a-custom-user-model),
just a related Profile model with a
[one-to-one relationship](https://docs.djangoproject.com/en/5.2/topics/auth/customizing/#extending-the-existing-user-model)
with the standard User model. This is defined in the `borrowd_users/` app.
